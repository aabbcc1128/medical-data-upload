<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Ù„ÙˆØ­Ø© Ø§Ù„ØªØ­ÙƒÙ… - Ù…Ù†ØµØ© Ø±ÙØ¹ Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª</title>
    <link href="output.css" rel="stylesheet">
    <script src="https://cdnjs.cloudflare.com/ajax/libs/PapaParse/5.3.0/papaparse.min.js"></script>
    <style>
        body { font-family: 'Amiri', sans-serif; background-color: #f5f7fa; margin: 0; }
        .main-content { padding: 1rem; }
        .header { display: flex; justify-content: space-between; align-items: center; background-color: #fff; padding: 0.5rem 1rem; border-bottom: 1px solid #dee2e6; }
        .logo { height: 40px; }
        .nav-actions { display: flex; align-items: center; gap: 1rem; }
        .filter-section { background-color: #fff; padding: 1rem; border-radius: 4px; margin-bottom: 1rem; }
        .filter-section label { margin-left: 0.5rem; }
        .filter-section select, .filter-section input { padding: 0.25rem; width: 100%; margin-bottom: 0.5rem; }
        .input-section { background-color: #fff; padding: 1rem; border-radius: 4px; margin-bottom: 1rem; }
        .input-section label { margin-left: 0.5rem; }
        .input-section input, .input-section select { padding: 0.25rem; width: 100%; margin-bottom: 0.5rem; }
        .table-container { background-color: #fff; padding: 1rem; border-radius: 4px; }
        table { width: 100%; border-collapse: collapse; }
        th, td { padding: 0.5rem; text-align: right; border-bottom: 1px solid #dee2e6; }
        th { background-color: #f8f9fa; }
        .action-btn { background-color: #28a745; color: white; border-radius: 50%; width: 30px; height: 30px; display: flex; align-items: center; justify-content: center; text-decoration: none; margin-left: 0.25rem; }
        .details-modal, .calendar-modal { display: none; position: fixed; top: 0; right: 0; width: 100%; height: 100%; background-color: rgba(0, 0, 0, 0.5); }
        .details-content, .calendar-content { background-color: #fff; margin: 5% auto; padding: 1rem; border-radius: 4px; width: 80%; max-width: 600px; }
    </style>
</head>
<body>
    <div class="main-content">
        <div class="header">
            <img src="assets/brandLogo.23c31b2e.svg" alt="Brand Logo" class="logo">
            <div class="nav-actions">
                <div class="flex gap-2">
                    <a href="#" class="action-btn" id="calendarBtn">ğŸ“…</a>
                    <a href="#" class="action-btn">ğŸ”</a>
                    <a href="#" class="action-btn">+</a>
                </div>
                <a href="#" class="text-blue-500">Ø§Ù„Ù„ØºØ©</a>
                <div class="w-8 h-8 bg-gray-300 rounded-full flex items-center justify-center">A</div>
                <button id="logoutBtn" class="bg-red-500 text-white px-4 py-1 rounded">ØªØ³Ø¬ÙŠÙ„ Ø§Ù„Ø®Ø±ÙˆØ¬</button>
            </div>
        </div>

        <div id="adminView" style="display: none;">
            <h2>Ù„ÙˆØ­Ø© Ø§Ù„ØªØ­ÙƒÙ… - Ø¹Ø±Ø¶ Ø§Ù„Ù…Ø¯ÙŠØ±</h2>
            <div class="filter-section">
                <h3>Ø¥Ø¯Ø±Ø§Ø¬ Ø§Ù„Ø¥Ø±Ø³Ø§Ù„Ø§Øª: <span id="totalEntriesAdmin">0</span></h3>
                <label>ØªØ­Ù…ÙŠÙ„ Ù…Ù„Ù CSV</label>
                <input type="file" id="fileInputAdmin" accept=".csv">
                <label>Ø§Ù„Ù…Ù†Ø·Ù‚Ø© *</label>
                <select id="regionFilterAdmin">
                    <option value="">Ø§Ø®ØªØ± Ø§Ù„Ù…Ù†Ø·Ù‚Ø©</option>
                    <option value="Ù…Ù†Ù‰">Ù…Ù†Ù‰</option>
                    <option value="Ø¹Ø±ÙØ§Øª">Ø¹Ø±ÙØ§Øª</option>
                    <option value="Ù…Ø²Ø¯Ù„ÙØ©">Ù…Ø²Ø¯Ù„ÙØ©</option>
                </select>
                <label>Ø§Ù„Ù…Ø³ØªØ´ÙÙ‰ *</label>
                <select id="hospitalFilterAdmin">
                    <option value="">Ø§Ø®ØªØ± Ø§Ù„Ù…Ø³ØªØ´ÙÙ‰</option>
                    <option value="Ù‡Ù„Ø§Ù„ Ø£Ø­Ù…Ø±">Ù‡Ù„Ø§Ù„ Ø£Ø­Ù…Ø±</option>
                    <option value="Ø§Ù„Ø­Ø±Ø³ Ø§Ù„ÙˆØ·Ù†ÙŠ">Ø§Ù„Ø­Ø±Ø³ Ø§Ù„ÙˆØ·Ù†ÙŠ</option>
                    <option value="ÙˆØ²Ø§Ø±Ø© Ø§Ù„Ø¯ÙØ§Ø¹">ÙˆØ²Ø§Ø±Ø© Ø§Ù„Ø¯ÙØ§Ø¹</option>
                    <option value="Ù…Ø³ØªØ´ÙÙ‰ ÙÙ‚ÙŠØ©">Ù…Ø³ØªØ´ÙÙ‰ ÙÙ‚ÙŠØ©</option>
                    <option value="Ø§Ù„Ù‚Ø·Ø§Ø¹ Ø§Ù„Ø®Ø§Øµ">Ø§Ù„Ù‚Ø·Ø§Ø¹ Ø§Ù„Ø®Ø§Øµ</option>
                    <option value="Ù…Ø³ØªØ´ÙÙ‰ Ù‚ÙˆÙ‰ Ø§Ù„Ø£Ù…Ù†">Ù…Ø³ØªØ´ÙÙ‰ Ù‚ÙˆÙ‰ Ø§Ù„Ø£Ù…Ù†</option>
                </select>
                <button id="resetFiltersAdmin" class="bg-green-500 text-white px-4 py-1 rounded mt-2">Ø¥Ø¹Ø§Ø¯Ø© ØªØ¹ÙŠÙŠÙ† Ø§Ù„ÙƒÙ„</button>
            </div>
            <div class="table-container">
                <table>
                    <thead>
                        <tr>
                            <th>Ø§Ù„Ù…Ù†Ø·Ù‚Ø©</th>
                            <th>Ø§Ù„Ù…Ø³ØªØ´ÙÙ‰</th>
                            <th>Ø§Ø³Ù… Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù…</th>
                            <th>ØªØ§Ø±ÙŠØ® Ø§Ù„Ø¥Ø±Ø³Ø§Ù„</th>
                            <th>Ø§Ù„Ø¥Ø¬Ø±Ø§Ø¡</th>
                        </tr>
                    </thead>
                    <tbody id="submissionTableAdmin"></tbody>
                </table>
            </div>
        </div>

        <div id="userView">
            <h2>Ù„ÙˆØ­Ø© Ø§Ù„ØªØ­ÙƒÙ… - Ø¥Ø¯Ø®Ø§Ù„ Ø¨ÙŠØ§Ù†Ø§Øª</h2>
            <div class="input-section">
                <h3>Ø¥Ø¯Ø®Ø§Ù„ Ø¨ÙŠØ§Ù†Ø§Øª Ø¬Ø¯ÙŠØ¯Ø©</h3>
                <label>Ø§Ù„Ù…Ù†Ø·Ù‚Ø© *</label>
                <select id="regionInput">
                    <option value="">Ø§Ø®ØªØ± Ø§Ù„Ù…Ù†Ø·Ù‚Ø©</option>
                    <option value="Ù…Ù†Ù‰">Ù…Ù†Ù‰</option>
                    <option value="Ø¹Ø±ÙØ§Øª">Ø¹Ø±ÙØ§Øª</option>
                    <option value="Ù…Ø²Ø¯Ù„ÙØ©">Ù…Ø²Ø¯Ù„ÙØ©</option>
                </select>
                <label>Ø§Ù„Ù…Ø³ØªØ´ÙÙ‰ *</label>
                <select id="hospitalInput">
                    <option value="">Ø§Ø®ØªØ± Ø§Ù„Ù…Ø³ØªØ´ÙÙ‰</option>
                    <option value="Ù‡Ù„Ø§Ù„ Ø£Ø­Ù…Ø±">Ù‡Ù„Ø§Ù„ Ø£Ø­Ù…Ø±</option>
                    <option value="Ø§Ù„Ø­Ø±Ø³ Ø§Ù„ÙˆØ·Ù†ÙŠ">Ø§Ù„Ø­Ø±Ø³ Ø§Ù„ÙˆØ·Ù†ÙŠ</option>
                    <option value="ÙˆØ²Ø§Ø±Ø© Ø§Ù„Ø¯ÙØ§Ø¹">ÙˆØ²Ø§Ø±Ø© Ø§Ù„Ø¯ÙØ§Ø¹</option>
                    <option value="Ù…Ø³ØªØ´ÙÙ‰ ÙÙ‚ÙŠØ©">Ù…Ø³ØªØ´ÙÙ‰ ÙÙ‚ÙŠØ©</option>
                    <option value="Ø§Ù„Ù‚Ø·Ø§Ø¹ Ø§Ù„Ø®Ø§Øµ">Ø§Ù„Ù‚Ø·Ø§Ø¹ Ø§Ù„Ø®Ø§Øµ</option>
                    <option value="Ù…Ø³ØªØ´ÙÙ‰ Ù‚ÙˆÙ‰ Ø§Ù„Ø£Ù…Ù†">Ù…Ø³ØªØ´ÙÙ‰ Ù‚ÙˆÙ‰ Ø§Ù„Ø£Ù…Ù†</option>
                </select>
                <label>Ø§Ø³Ù… Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù… *</label>
                <input type="text" id="usernameInput" placeholder="Ø£Ø¯Ø®Ù„ Ø§Ø³Ù… Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù…" readonly>
                <label>ØªØ§Ø±ÙŠØ® Ø§Ù„Ø¥Ø±Ø³Ø§Ù„ *</label>
                <input type="date" id="dateInput">
                <button id="submitEntryBtn" class="bg-blue-500 text-white px-4 py-1 rounded mt-2">Ø¥Ø±Ø³Ø§Ù„</button>
                <label>ØªØ­Ù…ÙŠÙ„ Ù…Ù„Ù CSV</label>
                <input type="file" id="fileInputUser" accept=".csv">
            </div>
            <div class="table-container">
                <table>
                    <thead>
                        <tr>
                            <th>Ø§Ù„Ù…Ù†Ø·Ù‚Ø©</th>
                            <th>Ø§Ù„Ù…Ø³ØªØ´ÙÙ‰</th>
                            <th>Ø§Ø³Ù… Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù…</th>
                            <th>ØªØ§Ø±ÙŠØ® Ø§Ù„Ø¥Ø±Ø³Ø§Ù„</th>
                            <th>Ø§Ù„Ø¥Ø¬Ø±Ø§Ø¡</th>
                        </tr>
                    </thead>
                    <tbody id="submissionTableUser"></tbody>
                </table>
            </div>
        </div>

        <div id="detailsModal" class="details-modal">
            <div class="details-content">
                <h3>ØªÙØ§ØµÙŠÙ„ Ø§Ù„Ø¥Ø±Ø³Ø§Ù„</h3>
                <table>
                    <thead>
                        <tr>
                            <th>Ø§Ù„Ù…Ù†Ø·Ù‚Ø©</th>
                            <th>Ø§Ù„Ù…Ø³ØªØ´ÙÙ‰</th>
                            <th>Ø§Ø³Ù… Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù…</th>
                            <th>ØªØ§Ø±ÙŠØ® Ø§Ù„Ø¥Ø±Ø³Ø§Ù„</th>
                        </tr>
                    </thead>
                    <tbody id="detailsTable"></tbody>
                </table>
                <button onclick="closeDetails()">Ø¥ØºÙ„Ø§Ù‚</button>
            </div>
        </div>

        <div id="calendarModal" class="calendar-modal">
            <div class="calendar-content">
                <h3>Ø¥Ø¯Ø®Ø§Ù„ Ø¨ÙŠØ§Ù†Ø§Øª Ø¬Ø¯ÙŠØ¯Ø©</h3>
                <label>Ø§Ù„Ù…Ù†Ø·Ù‚Ø© *</label>
                <select id="calendarRegionInput">
                    <option value="">Ø§Ø®ØªØ± Ø§Ù„Ù…Ù†Ø·Ù‚Ø©</option>
                    <option value="Ù…Ù†Ù‰">Ù…Ù†Ù‰</option>
                    <option value="Ø¹Ø±ÙØ§Øª">Ø¹Ø±ÙØ§Øª</option>
                    <option value="Ù…Ø²Ø¯Ù„ÙØ©">Ù…Ø²Ø¯Ù„ÙØ©</option>
                </select>
                <label>Ø§Ù„Ù…Ø³ØªØ´ÙÙ‰ *</label>
                <select id="calendarHospitalInput">
                    <option value="">Ø§Ø®ØªØ± Ø§Ù„Ù…Ø³ØªØ´ÙÙ‰</option>
                    <option value="Ù‡Ù„Ø§Ù„ Ø£Ø­Ù…Ø±">Ù‡Ù„Ø§Ù„ Ø£Ø­Ù…Ø±</option>
                    <option value="Ø§Ù„Ø­Ø±Ø³ Ø§Ù„ÙˆØ·Ù†ÙŠ">Ø§Ù„Ø­Ø±Ø³ Ø§Ù„ÙˆØ·Ù†ÙŠ</option>
                    <option value="ÙˆØ²Ø§Ø±Ø© Ø§Ù„Ø¯ÙØ§Ø¹">ÙˆØ²Ø§Ø±Ø© Ø§Ù„Ø¯ÙØ§Ø¹</option>
                    <option value="Ù…Ø³ØªØ´ÙÙ‰ ÙÙ‚ÙŠØ©">Ù…Ø³ØªØ´ÙÙ‰ ÙÙ‚ÙŠØ©</option>
                    <option value="Ø§Ù„Ù‚Ø·Ø§Ø¹ Ø§Ù„Ø®Ø§Øµ">Ø§Ù„Ù‚Ø·Ø§Ø¹ Ø§Ù„Ø®Ø§Øµ</option>
                    <option value="Ù…Ø³ØªØ´ÙÙ‰ Ù‚ÙˆÙ‰ Ø§Ù„Ø£Ù…Ù†">Ù…Ø³ØªØ´ÙÙ‰ Ù‚ÙˆÙ‰ Ø§Ù„Ø£Ù…Ù†</option>
                </select>
                <label>Ø§Ø³Ù… Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù… *</label>
                <input type="text" id="calendarUsernameInput" placeholder="Ø£Ø¯Ø®Ù„ Ø§Ø³Ù… Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù…" readonly>
                <label>ØªØ§Ø±ÙŠØ® Ø§Ù„Ø¥Ø±Ø³Ø§Ù„ *</label>
                <input type="date" id="calendarDateInput">
                <button id="calendarSubmitBtn" class="bg-blue-500 text-white px-4 py-1 rounded mt-2">Ø¥Ø±Ø³Ø§Ù„</button>
                <button onclick="closeCalendar()">Ø¥ØºÙ„Ø§Ù‚</button>
            </div>
        </div>

        <p class="text-sm text-gray-500 mt-2">Ù…Ø¯Ø¹ÙˆÙ… Ù…Ù† Ascend Solutions</p>
    </div>

    <script>
        // Ø§Ù„ØªØ­Ù‚Ù‚ Ù…Ù† Ø­Ø§Ù„Ø© ØªØ³Ø¬ÙŠÙ„ Ø§Ù„Ø¯Ø®ÙˆÙ„
        if (!localStorage.getItem('isAuthenticated')) {
            alert("ÙŠØ±Ø¬Ù‰ ØªØ³Ø¬ÙŠÙ„ Ø§Ù„Ø¯Ø®ÙˆÙ„ Ø£ÙˆÙ„Ø§Ù‹!");
            window.location.href = "index.html";
        }

        // ØªØ­Ø¯ÙŠØ¯ Ø§Ù„Ø¯ÙˆØ± ÙˆØ§Ø³Ù… Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù…
        let userRole = localStorage.getItem('userRole') || 'User';
        let username = localStorage.getItem('username') || 'admin@example.com';

        // Ø¹Ø±Ø¶ Ø§Ù„ÙˆØ§Ø¬Ù‡Ø© Ø¨Ù†Ø§Ø¡Ù‹ Ø¹Ù„Ù‰ Ø§Ù„Ø¯ÙˆØ±
        const adminView = document.getElementById('adminView');
        const userView = document.getElementById('userView');
        if (userRole === 'Admin') {
            adminView.style.display = 'block';
            userView.style.display = 'none';
        } else {
            adminView.style.display = 'none';
            userView.style.display = 'block';
            document.getElementById('usernameInput').value = username;
            document.getElementById('calendarUsernameInput').value = username;
        }

        // ØªØ­Ù…ÙŠÙ„ Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª Ù…Ù† localStorage
        let entries = JSON.parse(localStorage.getItem('entries')) || [];

        // Ø¯Ø§Ù„Ø© Ù„ØªØ­Ø¯ÙŠØ« Ø¬Ø¯ÙˆÙ„ Ø§Ù„Ø¥Ø¯Ø®Ø§Ù„Ø§Øª
        function updateTable(tbodyId, filterRole = null) {
            const tbody = document.getElementById(tbodyId);
            tbody.innerHTML = '';
            let filteredEntries = entries;

            // ØªØµÙÙŠØ© Ø¨Ù†Ø§Ø¡Ù‹ Ø¹Ù„Ù‰ Ø§Ù„Ø¯ÙˆØ±
            if (filterRole === 'User') {
                filteredEntries = entries.filter(entry => entry.username === username);
            }

            // ØªØµÙÙŠØ© Ø¨Ù†Ø§Ø¡Ù‹ Ø¹Ù„Ù‰ Ø§Ù„ÙÙ„Ø§ØªØ± (Ù„Ù„Ù…Ø¯ÙŠØ± ÙÙ‚Ø·)
            if (tbodyId === 'submissionTableAdmin') {
                const regionFilter = document.getElementById('regionFilterAdmin').value;
                const hospitalFilter = document.getElementById('hospitalFilterAdmin').value;
                if (regionFilter) {
                    filteredEntries = filteredEntries.filter(entry => entry.region === regionFilter);
                }
                if (hospitalFilter) {
                    filteredEntries = filteredEntries.filter(entry => entry.hospital === hospitalFilter);
                }
            }

            filteredEntries.forEach(entry => {
                const tr = document.createElement('tr');
                tr.innerHTML = `
                    <td>${entry.region}</td>
                    <td>${entry.hospital}</td>
                    <td>${entry.username}</td>
                    <td>${entry.date}</td>
                    <td><button class="action-btn" onclick="showDetails(this)">ğŸ‘ï¸</button></td>
                `;
                tbody.appendChild(tr);
            });

            // ØªØ­Ø¯ÙŠØ« Ø¹Ø¯Ø¯ Ø§Ù„Ø¥Ø¯Ø®Ø§Ù„Ø§Øª
            const totalEntries = filteredEntries.length;
            document.getElementById(tbodyId === 'submissionTableAdmin' ? 'totalEntriesAdmin' : 'totalEntriesUserFooter').textContent = totalEntries;
        }

        // ØªØ­Ø¯ÙŠØ« Ø§Ù„Ø¬Ø¯Ø§ÙˆÙ„ Ø¹Ù†Ø¯ Ø§Ù„ØªØ­Ù…ÙŠÙ„
        updateTable('submissionTableAdmin');
        updateTable('submissionTableUser', 'User');

        // Ø¥Ø¶Ø§ÙØ© Ø¥Ø¯Ø®Ø§Ù„ Ø¬Ø¯ÙŠØ¯ Ù…Ù† Ø§Ù„Ù†Ù…ÙˆØ°Ø¬ Ø§Ù„Ø£Ø³Ø§Ø³ÙŠ
        document.getElementById('submitEntryBtn').addEventListener('click', () => {
            const region = document.getElementById('regionInput').value;
            const hospital = document.getElementById('hospitalInput').value;
            const date = document.getElementById('dateInput').value;
            if (!region || !hospital || !date) {
                alert('ÙŠØ±Ø¬Ù‰ Ù…Ù„Ø¡ Ø¬Ù…ÙŠØ¹ Ø§Ù„Ø­Ù‚ÙˆÙ„!');
                return;
            }
            const newEntry = { region, hospital, username, date };
            entries.push(newEntry);
            localStorage.setItem('entries', JSON.stringify(entries));
            updateTable('submissionTableAdmin');
            updateTable('submissionTableUser', 'User');
            alert('ØªÙ… Ø¥Ø¶Ø§ÙØ© Ø§Ù„Ø¥Ø¯Ø®Ø§Ù„ Ø¨Ù†Ø¬Ø§Ø­!');
        });

        // Ø¥Ø¶Ø§ÙØ© Ø¥Ø¯Ø®Ø§Ù„ Ø¬Ø¯ÙŠØ¯ Ù…Ù† Ø§Ù„Ù†Ù…ÙˆØ°Ø¬ Ø§Ù„Ù…Ù†Ø¨Ø«Ù‚
        document.getElementById('calendarSubmitBtn').addEventListener('click', () => {
            const region = document.getElementById('calendarRegionInput').value;
            const hospital = document.getElementById('calendarHospitalInput').value;
            const date = document.getElementById('calendarDateInput').value;
            if (!region || !hospital || !date) {
                alert('ÙŠØ±Ø¬Ù‰ Ù…Ù„Ø¡ Ø¬Ù…ÙŠØ¹ Ø§Ù„Ø­Ù‚ÙˆÙ„!');
                return;
            }
            const newEntry = { region, hospital, username, date };
            entries.push(newEntry);
            localStorage.setItem('entries', JSON.stringify(entries));
            updateTable('submissionTableAdmin');
            updateTable('submissionTableUser', 'User');
            closeCalendar();
            alert('ØªÙ… Ø¥Ø¶Ø§ÙØ© Ø§Ù„Ø¥Ø¯Ø®Ø§Ù„ Ø¨Ù†Ø¬Ø§Ø­!');
        });

        // ØªØ­Ù…ÙŠÙ„ Ù…Ù„Ù CSV
        function handleCSVUpload(fileInputId, callback) {
            const fileInput = document.getElementById(fileInputId);
            const file = fileInput.files[0];
            if (!file) {
                alert('ÙŠØ±Ø¬Ù‰ Ø§Ø®ØªÙŠØ§Ø± Ù…Ù„Ù CSV');
                return;
            }
            Papa.parse(file, {
                header: true,
                complete: function(results) {
                    const data = results.data;
                    data.forEach(row => {
                        if (row['Ø§Ù„Ù…Ù†Ø·Ù‚Ø©'] && row['Ø§Ù„Ù…Ø³ØªØ´ÙÙ‰'] && row['Ø§Ø³Ù… Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù…'] && row['ØªØ§Ø±ÙŠØ® Ø§Ù„Ø¥Ø±Ø³Ø§Ù„']) {
                            entries.push({
                                region: row['Ø§Ù„Ù…Ù†Ø·Ù‚Ø©'],
                                hospital: row['Ø§Ù„Ù…Ø³ØªØ´ÙÙ‰'],
                                username: row['Ø§Ø³Ù… Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù…'],
                                date: row['ØªØ§Ø±ÙŠØ® Ø§Ù„Ø¥Ø±Ø³Ø§Ù„']
                            });
                        }
                    });
                    localStorage.setItem('entries', JSON.stringify(entries));
                    callback();
                    alert('ØªÙ… ØªØ­Ù…ÙŠÙ„ Ù…Ù„Ù CSV Ø¨Ù†Ø¬Ø§Ø­!');
                },
                error: function(error) {
                    alert('Ø®Ø·Ø£ ÙÙŠ ØªØ­Ù„ÙŠÙ„ Ù…Ù„Ù CSV: ' + error.message);
                }
            });
        }

        document.getElementById('fileInputAdmin').addEventListener('change', () => {
            handleCSVUpload('fileInputAdmin', () => {
                updateTable('submissionTableAdmin');
                updateTable('submissionTableUser', 'User');
            });
        });

        document.getElementById('fileInputUser').addEventListener('change', () => {
            handleCSVUpload('fileInputUser', () => {
                updateTable('submissionTableAdmin');
                updateTable('submissionTableUser', 'User');
            });
        });

        // ØªØ·Ø¨ÙŠÙ‚ Ø§Ù„ÙÙ„Ø§ØªØ±
        document.getElementById('regionFilterAdmin').addEventListener('change', () => updateTable('submissionTableAdmin'));
        document.getElementById('hospitalFilterAdmin').addEventListener('change', () => updateTable('submissionTableAdmin'));
        document.getElementById('resetFiltersAdmin').addEventListener('click', () => {
            document.getElementById('regionFilterAdmin').value = '';
            document.getElementById('hospitalFilterAdmin').value = '';
            updateTable('submissionTableAdmin');
        });

        // Ø¹Ø±Ø¶ Ø§Ù„ØªÙØ§ØµÙŠÙ„
        function showDetails(button) {
            const row = button.closest('tr');
            const region = row.cells[0].textContent;
            const hospital = row.cells[1].textContent;
            const username = row.cells[2].textContent;
            const date = row.cells[3].textContent;

            const detailsTable = document.getElementById('detailsTable');
            detailsTable.innerHTML = `
                <tr>
                    <td>${region}</td>
                    <td>${hospital}</td>
                    <td>${username}</td>
                    <td>${date}</td>
                </tr>
            `;
            document.getElementById('detailsModal').style.display = 'block';
        }

        function closeDetails() {
            document.getElementById('detailsModal').style.display = 'none';
        }

        // Ø¹Ø±Ø¶ ÙˆØ¥ØºÙ„Ø§Ù‚ Ø§Ù„Ù†Ù…ÙˆØ°Ø¬ Ø§Ù„Ù…Ù†Ø¨Ø«Ù‚ Ù„Ù„ØªÙ‚ÙˆÙŠÙ…
        document.getElementById('calendarBtn').addEventListener('click', () => {
            document.getElementById('calendarModal').style.display = 'block';
            document.getElementById('calendarUsernameInput').value = username;
        });

        function closeCalendar() {
            document.getElementById('calendarModal').style.display = 'none';
            document.getElementById('calendarRegionInput').value = '';
            document.getElementById('calendarHospitalInput').value = '';
            document.getElementById('calendarDateInput').value = '';
        }

        // ØªØ³Ø¬ÙŠÙ„ Ø§Ù„Ø®Ø±ÙˆØ¬
        document.getElementById('logoutBtn').addEventListener('click', () => {
            localStorage.removeItem('isAuthenticated');
            localStorage.removeItem('userRole');
            localStorage.removeItem('username');
            localStorage.removeItem('entries');
            window.location.href = "index.html";
        });
    </script>
</body>
</html>
